# 基本設計
## 全体像
<img width="1997" height="1198" alt="Image" src="https://github.com/user-attachments/assets/1bd32fea-87b1-4a20-b8b5-76603c88979f" />

- UART通信速度  

  - エアデータ電装部，機体下電装部はSD書き込み以外のタスクもあるため460800bpsにした
  - メインマイコンはGPSからデータを受信するのみであり，TWELITEにデータを送信するだけなので，GPSとTWELITEで同じUARTポートを用いた(GPSはRX,TWELTEはTX)
  - メイン2層目へのSD書き込みのUARTは操舵角と同じUARTポートを用いた
  - メイン2層目へのスピーカー処理用のUARTはSD書き込みとは別のUARTチャンネルを用いた(データ量が多すぎるため，分けた)
  - GPSとTWELITEは9800bps，操舵角が115200bps，(GPSは460800bps,TWELITEは230400bpsまでいける)
  - 通信速度は速い方がデータの遅延なども少なくなるので早いに越したことはない
- 各コンポーネントの必要性
  - 機体下：超音波センサを機体下部に搭載する必要(高度測定のため)
  - エアデータ：ピトー管を機体外部に搭載する必要(機速測定のため)
  - 操縦桿：パイロットの近くに配置する必要(ラダー制御のため)
  - 電源部：防水が必要な区画を最小限にするため独立
  - スピーカー：聞きやすい位置に配置するために独立
  - ラダー：垂直尾翼の機構にサーボのみ配置(テール側の重量を最小限にするため)
  - 無線ハブ：無線が通じる部分であればどこでも可(CFRPは電磁波を遮断するため，桁内部などはなし)
  - メイン：独立
- メインマイコンはRaspberry Pi Pico
  - UARTがたくさん欲しい(ボードマネージャーを[特定のもの](https://logikara.blog/raspi-pico-arduinoide/)にすれば，ハードでのUARTピン以外にソフトでUARTのピンを指定することが可能)
  - Arduino IDEを用いてプログラムできる
  - コンパクト
  - 24代である程度使い慣れていた
- 他のマイコンは小さいのでSeeed Studio XIAO RP2040
- ラダーのサーボモーターは鳥科で代々使っている近藤科学の[KRS-4034HV ICS](https://kondo-robot.com/product/krs-4034hv-ics)
  - トルクについて定量的な要求を出すのは難しいが，前年これで不足はなかった
  - テールヘビーを避けるため軽量なものが良い
  - （まず無いけど）水平尾翼を電装制御したくなった場合でも，複数のサーボをデイジーチェーン接続できるので電装の設計変更が少ない
- 操縦桿の制御マイコンはケーブルの配線上，独立させることができな為，メイン基板に載せたが，メインのセンサと配線を繋げたりはしない
  - 操舵系はクリティカルなため余計な機能を混ぜない
- エアデータ電装部は有線接続(電源通信両方)
  - パイロットにリアルタイムで対気速度を繋げたい
  - 他と同期してデータを取りたい
- TWELITEは一度に処理できるデータの量と処理時間が遅い
  - 送るデータを何個かに分けて送る
  - プログラム上でメインマイコンでのセンサの測定周期と独立させる(今回はマルチコアを用いた)
  - 電装班の技術力的に通信は有線の方が安心(Bluetooth/WiFiはムズイ)
  - 電源は独立でも良いが，通信は有線なのでまとめて有線
- 電源設計
  - サーボモータ用に3セルのLiPoバッテリーを搭載
  - 火災防止のためサーボに過電流保護を挟んで供給
  - 電源はサーボ用のLiPoバッテリーのみで，ロガー系もこれから供給する
    - ロガー系からの故障リスクよりも，電源を分散させる手間の方が大きいと判断
    - 高く計測のための操舵系の信号線がロガー系に繋がっているため，電源を完全に分離してまで故障を防ぐのは意味がない
    - 電源を分散させると，各機器の起動タイミングによるもんだん・各バッテリーの残量管理の手間・電源投入の手間が増える
- 姿勢センサの受信側のデバイスはスマホのシリアルモニタ
  -　液晶などを使うのはだるい
  - スマホアプリの開発は面倒だが，シリアルモニタならアプリがあるため，マイコンとつなげるだけで複雑なことがいらず楽
## 物理的な配置
- 写真載せる
- 操縦桿はパイロットが操作しやすい位置
  - 操縦桿は重心移動しながらの操作を可能にするため，パイロットが握るフレームの位置に取り付け
- 機体下電装部は超音波センサを湖面に垂直に向けることができれば場所は任意(できるだけ機体の最下部の部分につくようには意識)
- スピーカー部は場所は任意(音が聞こえるならどこでも可)
- エアデータ電装部はコクピ上
  - 去年までは左翼に配置していたが，今年はAoA,AoSをとりつけるのと電装をコクピ近くで完結させるためにコクピ上に置くことにした。
  - コクピの上からCFRPのパイプを用いて角を生やした
